<script type="text/javascript">
    $(document).ready(function(){
        $("select#gallery_section_id").change(function(){
            var id_value_string = $(this).val();
            if (id_value_string == "") {
                // if the id is empty remove all the sub_selection options from being selectable and do not do any ajax
                $("select#gallery_sub_section_id option").remove();
                var row = "<option value=\"" + "" + "\">" + "" + "</option>";
                $(row).appendTo("select#gallery_sub_section_id");
            }
            else {
                // Send the request and update sub category dropdown
                $.ajax({
                    dataType: "json",
                    cache: false,
                    url: '/sub_sections/for_sectionid/' + id_value_string,
                    timeout: 2000,
                    error: function(XMLHttpRequest, errorTextStatus, error){
                        alert("Failed to submit : "+ errorTextStatus+" ;"+error);
                    },
                    success: function(data){                    
                        // Clear all options from sub category select
                        $("select#gallery_sub_section_id option").remove();
                        //put in a empty default line
                        var row = "<option value=\"" + "" + "\">" + "" + "</option>";
                        $(row).appendTo("select#gallery_sub_section_id");                        
                        // Fill sub category select
                        $.each(data, function(i, j){
                            row = "<option value=\"" + j.sub_section.id + "\">" + j.sub_section.name + "</option>";  
                            $(row).appendTo("select#gallery_sub_section_id");                    
                        });            
                     }
                });
            };
                });
    });
</script>





<h1>Sign up</h1>

<%= form_for(@user) do |f| %>
<%= render 'shared/error_messages', :object => f.object %>
  <div class="field">
    <%= f.label :name %><br />
    <%= f.text_field :name %>








  </div>
<div class="field">
<%= f.label :Maa %><br />

<%= select 'user', 'name', %w(Valitse -------------- Suomi Ruotsi Kiina Viro), :include_blank => false %>
</div>

<div class="field">
<%= f.label :Kesto %><br />
  <%= check_box ("yes", "no") %>
<%= f.label :yli %><br />
  <%= check_box ("yes", "no") %>
<%= f.label :No %><br />
 </div>

<div class="field">
<%= f.label :Teht채v채nimike %><br />


<%= text_area "post", "body", "cols" => 20, "rows" => 40%>



</div>

<div class="field">

<p>
    < %= f.label :section_id %><br />      
    < %=  collection_select(:gallery, :section_id, Section.all, :id, :name , options ={:prompt => ""} ) %>
    </p>
  <p>
    < %= f.label :sub_section_id %><br />      
    < %= collection_select(:gallery, :sub_section_id, SubSection.find_all_by_section_id(@gallery.section_id), :id, :name, options ={:prompt => ""}) %>
  </p>

</div>

<div class="field">

<select name="post[person_id]">
    <option value="1">Kokop채iv채</option>
    <option value="2">Osa-aika</option>
    <option value="3">Muu</option>
  </select>


</div>



  <div class="field">
    <%= f.label :email %><br />
    <%= f.text_field :email %>
  </div>
  <div class="field">
    <%= f.label :password %><br />
    <%= f.password_field :password %>
  </div>
  <div class="field">
    <%= f.label :password_confirmation, "Confirmation" %><br />
    <%= f.password_field :password_confirmation %>
  </div>
  <div class="actions">
    <%= f.submit "Sign up" %>
  </div>
<% end %>





